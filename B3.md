# Вариант B3

### Задание 1 (15 баллов)
Пусть задан конечный автомат A = (Q, Σ, q₀, δ, F), где:  
Q = {q₀, q₁, q₂, q₃} — множество состояний;  
Σ = {a, b} — множество входных событий;  
δ = {(q₀, a, q₂), (q₂, a, q₁), (q₁, b, q₃), (q₃, a, q₀), (q₂, b, q₃), (q₁, b, q₀)} — функция переходов;  
F = {q₃} — множество заключительных состояний.  

Постройте характеристические двоичные функции, представляющие этот автомат. Постройте BDD, представляющую этот автомат.

---

#### Решение

**Шаг 1: Кодирование состояний**

4 состояния → нужно 2 бита: s₁, s₀

| Состояние | s₁ | s₀ |
|-----------|----|----|
| q₀ | 0 | 0 |
| q₁ | 0 | 1 |
| q₂ | 1 | 0 |
| q₃ | 1 | 1 |

**Шаг 2: Кодирование входных символов**

2 символа → 1 бит: x (a = 0, b = 1)

**Шаг 3: Таблица переходов**

| Переход | s₁ | s₀ | x | s₁' | s₀' |
|---------|----|----|---|-----|-----|
| (q₀, a, q₂) | 0 | 0 | 0 | 1 | 0 |
| (q₂, a, q₁) | 1 | 0 | 0 | 0 | 1 |
| (q₁, b, q₃) | 0 | 1 | 1 | 1 | 1 |
| (q₃, a, q₀) | 1 | 1 | 0 | 0 | 0 |
| (q₂, b, q₃) | 1 | 0 | 1 | 1 | 1 |
| (q₁, b, q₀) | 0 | 1 | 1 | 0 | 0 |

**Примечание:** Последние два перехода (q₁, b, q₃) и (q₁, b, q₀) создают недетерминизм для пары (q₁, b). В BDD это отражается дизъюнкцией.

**Шаг 4: Характеристическая функция переходов T(s₁, s₀, x, s₁', s₀')**

T = (¬s₁∧¬s₀∧¬x∧s₁'∧¬s₀') ∨ (s₁∧¬s₀∧¬x∧¬s₁'∧s₀') ∨ (¬s₁∧s₀∧x∧s₁'∧s₀') ∨ (s₁∧s₀∧¬x∧¬s₁'∧¬s₀') ∨ (s₁∧¬s₀∧x∧s₁'∧s₀') ∨ (¬s₁∧s₀∧x∧¬s₁'∧¬s₀')

**Шаг 5: Характеристические функции**

- **Начальное состояние:** I(s₁, s₀) = ¬s₁ ∧ ¬s₀
- **Принимающие состояния:** F(s₁, s₀) = s₁ ∧ s₀

**Шаг 6: BDD (схема)**

Для порядка переменных s₁ < s₀ < x < s₁' < s₀':

```
            [s₁]
           /    \
         0/      \1
         /        \
      [s₀]       [s₀]
      /  \       /  \
     0    1     0    1
    /      \   /      \
  [x]     [x] [x]    [x]
  ...     ... ...    ...
```

BDD будет иметь 5 переменных и терминальные узлы 0, 1.

---

### Задание 2 (10 баллов)
Один известный скрипач прибыл на концерт в город. Когда он ненадолго отлучился из комнаты, его скрипка работы Страдивари была украдена. В результате расследования полиции было выявлено 4 подозреваемых А, В, С и D. Каждый из них дал показания:  
A: Меня не было в городе в момент кражи.  
B: С - виновен.  
C: То, что сказал В, неправда.  
D: То, что сказал С, правда.  

Кто виновен, если известно, что утверждения вора ложны, а утверждения всех остальных истинны.

---

#### Решение

**Шаг 1: Формализация**

Пусть X — вор (X ∈ {A, B, C, D}). Высказывания:
- Sₐ: «A не был в городе» = ¬InCity(A)
- Sᵦ: «C виновен» = (X = C)
- Sᵧ: «То, что сказал B, неправда» = ¬Sᵦ = (X ≠ C)
- Sᴅ: «То, что сказал C, правда» = Sᵧ = (X ≠ C)

**Шаг 2: Анализ по случаям**

**Случай X = A (вор — A):**
- Sₐ ложно (вор лжёт) → A был в городе ✓
- Sᵦ истинно (B не вор) → X = C, но X = A — противоречие! ✗

**Случай X = B (вор — B):**
- Sᵦ ложно (вор лжёт) → X ≠ C ✓ (действительно, X = B ≠ C)
- Sₐ истинно → A не был в городе ✓
- Sᵧ истинно (C не вор) → X ≠ C ✓
- Sᴅ истинно (D не вор) → X ≠ C ✓

Все условия выполнены! ✓

**Случай X = C (вор — C):**
- Sᵧ ложно (вор лжёт) → ¬(X ≠ C) → X = C ✓
- Sᵦ истинно (B не вор) → X = C ✓
- Sᴅ истинно (D не вор) → X ≠ C — противоречие! ✗

**Случай X = D (вор — D):**
- Sᴅ ложно (вор лжёт) → ¬(X ≠ C) → X = C, но X = D — противоречие! ✗

**Ответ:** Виновен **B**.

---

### Задание 3 (10 баллов)
В следующей схеме умозаключений свяжите с каждым предикатом высказывание на естественном языке, сформулируйте умозаключение и постройте доказательство на естественном языке в соответствии со схемой доказательства методом резолюции, если такое доказательство существует:  

F1: (∃x: P(x)) (∀y: Q(y)) S(x,y)  
F2: ¬(∃x: P(x)) (∃y: (T(y)) S(x,y)  
R: (∀x Q(x)) ¬T(x)

---

#### Решение

**Шаг 1: Интерпретация предикатов**

- P(x) — x является программистом
- Q(y) — y является компьютером
- T(y) — y неисправен
- S(x, y) — x использует y

**Шаг 2: Формулировка на естественном языке**

- F1: Существует программист, который использует все компьютеры.
- F2: Ни один программист не использует неисправное оборудование.
- R: Все компьютеры исправны. (Т.е. для любого x: если x — компьютер, то x не неисправен)

**Примечание:** Формулы в условии записаны нестандартно. Интерпретирую:
- F1: ∃x(P(x) ∧ ∀y(Q(y) → S(x,y)))
- F2: ¬∃x(P(x) ∧ ∃y(T(y) ∧ S(x,y))) = ∀x(P(x) → ∀y(T(y) → ¬S(x,y)))
- R: ∀x(Q(x) → ¬T(x))

**Шаг 3: Преобразование в КНФ**

**F1:** ∃x(P(x) ∧ ∀y(Q(y) → S(x,y)))
- Сколемизация: P(c) ∧ ∀y(¬Q(y) ∨ S(c,y))
- Дизъюнкты: (1) P(c), (2) ¬Q(y) ∨ S(c,y)

**F2:** ∀x∀y(¬P(x) ∨ ¬T(y) ∨ ¬S(x,y))
- Дизъюнкт: (3) ¬P(x) ∨ ¬T(y) ∨ ¬S(x,y)

**¬R:** ∃x(Q(x) ∧ T(x))
- Сколемизация: Q(d) ∧ T(d)
- Дизъюнкты: (4) Q(d), (5) T(d)

**Шаг 4: Метод резолюций**

(6) Из (2)[y:=d] и (4): S(c, d)  [резольвента ¬Q(d) ∨ S(c,d) и Q(d)]

(7) Из (3)[x:=c, y:=d] и (1): ¬T(d) ∨ ¬S(c,d)  [резольвента ¬P(c) ∨ ¬T(d) ∨ ¬S(c,d) и P(c)]

(8) Из (7) и (5): ¬S(c,d)  [резольвента ¬T(d) ∨ ¬S(c,d) и T(d)]

(9) Из (8) и (6): □  [пустой дизъюнкт]

**Ответ:** Заключение R **доказано** методом резолюций.

**Рассуждение на естественном языке:** Если существует программист, использующий все компьютеры, и никто не использует неисправное оборудование, то все компьютеры исправны (иначе программист использовал бы неисправный компьютер).

---

### Задание 4 (10 баллов)
Проверьте корректность приведенных ниже двух фрагментов программ S по отношению к предусловию I и постусловию R с помощью построения слабейшего предусловия wp(S, R):  

| Вариант | Предусловие I    | Фрагмент программы S       | Постусловие R      |
|---------|-------------------|----------------------------|---------------------|
| 1       | {True}            | x := 2; y := 3+x;          | x + y ≥ 0          |
| 2       | {z + a > c}       | z := 2*z; a := a+1;        | {z + a > c+2}      |

Если фрагмент программы некорректен, то приведите пример некорректного вычисления (в котором исходные данные удовлетворяют предусловию).

---

#### Решение

**Вариант 1: {True} x := 2; y := 3+x; {x + y ≥ 0}**

**Шаг 1:** wp("y := 3+x", x + y ≥ 0)
- Подставляем 3+x вместо y: x + (3+x) ≥ 0
- Получаем: 2x + 3 ≥ 0

**Шаг 2:** wp("x := 2", 2x + 3 ≥ 0)
- Подставляем 2 вместо x: 2·2 + 3 ≥ 0
- Получаем: 7 ≥ 0 ≡ **True**

**Шаг 3:** Проверка: I → wp(S, R)?
- True → True ✓

**Ответ 1:** Программа **корректна**.

---

**Вариант 2: {z + a > c} z := 2*z; a := a+1; {z + a > c+2}**

**Шаг 1:** wp("a := a+1", z + a > c + 2)
- Подставляем a+1 вместо a: z + (a+1) > c + 2
- Получаем: z + a + 1 > c + 2, т.е. **z + a > c + 1**

**Шаг 2:** wp("z := 2*z", z + a > c + 1)
- Подставляем 2*z вместо z: 2z + a > c + 1

**Шаг 3:** Проверка: I → wp(S, R)?
- I: z + a > c
- wp: 2z + a > c + 1

Нужно проверить: (z + a > c) → (2z + a > c + 1)?

Это **НЕ ВЕРНО** в общем случае.

**Контрпример:** z = -5, a = 10, c = 4
- Предусловие: z + a = -5 + 10 = 5 > 4 = c ✓
- После программы: z' = 2·(-5) = -10, a' = 10 + 1 = 11
- Постусловие: z' + a' = -10 + 11 = 1 > c + 2 = 6? НЕТ, 1 < 6 ✗

**Ответ 2:** Программа **некорректна**. Контрпример: z = -5, a = 10, c = 4.

---

### Задание 5 (15 баллов)
Существуют ли в этом перечне эквивалентные формулы? Для обоснования приведите вычисления:  
a) G(p → Xp)  
б) ¬p U p  
в) ¬p U G p  
г) F G p  
д) F p ∧ G(p → X p)

---

#### Решение

**Шаг 1: Анализ формулы (б) ¬p U p**

φ U ψ истинно, если ψ станет истинным, и до этого момента φ истинно.

¬p U p: ¬p держится до первого p. Но также p U p ≡ p.

Если в начальном состоянии p истинно, то ¬p U p истинно (ψ = p уже истинно).
Если p ложно, нужно дождаться p.

**Вывод:** ¬p U p ≡ **F p** (когда-нибудь p)

**Шаг 2: Анализ формулы (а) G(p → Xp)**

Всегда: если p, то в следующем состоянии тоже p.

Это означает: если p когда-либо станет истинным, оно останется истинным навсегда.

**Шаг 3: Анализ формулы (д) F p ∧ G(p → Xp)**

Когда-нибудь p будет, и с этого момента p останется навсегда.

Это эквивалентно **F G p**.

**Шаг 4: Анализ формулы (в) ¬p U G p**

¬p держится до момента, когда G p станет истинным.

G p означает «p всегда (с текущего момента)».

¬p U G p: сначала p ложно, потом наступает момент, с которого p всегда истинно.

**Это также эквивалентно F G p.**

**Шаг 5: Анализ формулы (г) F G p**

Когда-нибудь начнётся период, в котором p всегда истинно.

**Шаг 6: Проверка эквивалентностей**

**Формулы (в), (г), (д) эквивалентны?**

- (г) F G p: когда-нибудь навсегда p.
- (в) ¬p U G p: ¬p до момента G p. Если p истинно изначально и навсегда, то G p истинно, и ¬p U G p истинно. Если p истинно изначально, но потом ложно, то G p ложно.

Контрпример для (в) ≡ (г): Вычисление σ = {p}, {p}, {p}, ... (p всегда).
- F G p: истинно (G p истинно с начала)
- ¬p U G p: G p истинно с начала, поэтому ¬p U G p истинно (U допускает немедленное выполнение правой части)

Другой контрпример: σ = {p}, ∅, {p}, {p}, {p}, ...
- F G p: истинно? G p с позиции 2 истинно → F G p истинно
- ¬p U G p: в позиции 0 p истинно, ¬p ложно. Но G p с позиции 0 ложно (в позиции 1 p ложно). Значит ¬p U G p требует ¬p в начале или немедленно G p. Здесь ни то ни другое → ложно.

**Вывод:** (в) и (г) **НЕ эквивалентны**.

**Формулы (г) и (д):**

- (д) F p ∧ G(p → Xp): когда-нибудь p, и раз став истинным, p остаётся навсегда.

Контрпример: σ = {p}, {p}, ... (p всегда)
- F p: истинно
- G(p → Xp): истинно
- F G p: истинно

σ = ∅, ∅, {p}, {p}, ...
- F p: истинно
- G(p → Xp): p появляется в позиции 2, далее всегда → истинно
- F G p: истинно

σ = {p}, ∅, ∅, ...
- F p: истинно
- G(p → Xp): в позиции 0 p истинно, Xp = p в позиции 1 = ложно → G(p → Xp) ложно
- F G p: ложно

**Вывод:** (г) и (д) ведут себя одинаково на этих примерах. **Они эквивалентны.**

**Ответ:**
- **(г) F G p** и **(д) F p ∧ G(p → Xp)** — **эквивалентны**
- Остальные формулы не эквивалентны друг другу

---

### Задание 6 (10 баллов)
Пусть M = (S, S₀, R, AP, L) — такая структура Крипке:  
S = {s₀, s₁, s₂, s₃}  
S₀ = {s₁, s₃}  
R = {(s₂, s₃), (s₂, s₀), (s₀, s₁), (s₁, s₂), (s₃, s₀), (s₂, s₂)}  
AP = {a, b}  
L(s₀) = {a}, L(s₁) = {a, b}, L(s₂) = {b}, L(s₃) = ∅  

Выполняется ли для M формула E G A(b U a)?

---

#### Решение

**Шаг 1: Понимание формулы E G A(b U a)**

- A(b U a): на ВСЕХ путях выполняется b U a (b держится до a, и a обязательно наступит)
- E G φ: существует путь, на котором G φ (всегда φ)
- E G A(b U a): существует путь, на котором в каждом состоянии выполняется A(b U a)

**Шаг 2: Построение графа структуры Крипке**

```
         ┌───────────────────────────────────────┐
         │                                       │
         ▼                                       │
    ┌─────────┐      ┌─────────┐      ┌─────────┐│
    │   s₀    │─────►│   s₁    │─────►│   s₂    ││
    │  L={a}  │      │ L={a,b} │      │  L={b}  │┘
    └─────────┘      └─────────┘      └─────────┘
         ▲                              │ │ ▲
         │              ┌───────────────┘ │ │
         │              ▼                 │ │
         │         ┌─────────┐            │ │
         └─────────│   s₃    │◄───────────┘ │
                   │  L=∅    │              │
                   └─────────┘              │
                                     ┌──────┘
                                     │(петля)
                                     └──────►
```

Переходы:
- s₀ → s₁
- s₁ → s₂
- s₂ → s₀, s₂ → s₃, s₂ → s₂ (петля)
- s₃ → s₀

**Шаг 3: Вычисление A(b U a) для каждого состояния**

**s₀:** L(s₀) = {a} — a истинно → b U a истинно (правая часть выполнена)
- Все пути из s₀ начинаются с a → A(b U a) ✓

**s₁:** L(s₁) = {a, b} — a истинно → b U a истинно
- A(b U a) ✓

**s₂:** L(s₂) = {b}, a ложно
- Пути из s₂: s₂→s₃, s₂→s₀, s₂→s₂
- Путь s₂→s₀: b, затем a → b U a ✓
- Путь s₂→s₃: L(s₃) = ∅, b ложно, a ложно. b U a требует b до a. В s₃: b ложно → b U a нарушается
- A(b U a) ✗ (не на всех путях)

**s₃:** L(s₃) = ∅, a и b ложны
- Путь s₃→s₀: в s₃ b ложно, a ложно → b U a требует немедленно b или a. Нет ни того, ни другого.
- A(b U a) ✗

**Шаг 4: Состояния с A(b U a) = true: {s₀, s₁}**

**Шаг 5: Проверка E G A(b U a)**

Нужно найти путь, на котором всегда A(b U a).

Путь из s₀: s₀ → s₁ → s₂ → ...
В s₂ A(b U a) ложно → G A(b U a) ложно на любом пути через s₂.

Путь s₀ → s₁ обязательно идёт в s₂ (единственный переход из s₁).

**Из s₀ и s₁ нет пути, избегающего s₂.**

**Шаг 6: Начальные состояния S₀ = {s₁, s₃}**

Из s₁: s₁ → s₂ → ... попадаем в s₂, где A(b U a) ложно.

Из s₃: s₃ → s₀ → s₁ → s₂ → ... снова попадаем в s₂.

**Нет пути, на котором G A(b U a).**

**Ответ:** Формула E G A(b U a) **НЕ выполняется** для M.